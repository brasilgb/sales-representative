import{r as f,x as F,j as e,Q as _,t as P}from"./app-CR3eLBj1.js";import{B as R}from"./app-sidebar-header-kqxOd9gO.js";import{I as A}from"./icon-DzMIdqc5.js";import{B as D}from"./button-B24Zs7v5.js";import{A as E}from"./app-layout-BSshuS44.js";import{S as L}from"./react-select.esm-CYAHj7Vj.js";import{C as p,a as j}from"./card-BROXjL3T.js";import{I as $}from"./input-error-QuNa-EJ_.js";import{L as x}from"./label-DRdTM8Zb.js";import{I as b}from"./input-D2MqHLND.js";import{B as k}from"./badge-4i3nNebF.js";import{f as q,e as i}from"./mask-lU1_jkkq.js";import{T as M,a as Q,b as u,c as o,d as U,e as r,f as z}from"./table-C9F712up.js";import{S as N}from"./shopping-cart-1wdYtZs2.js";import{A as H}from"./arrow-left-D7pXidIB.js";import{U as V}from"./user-2MyGpyAy.js";import"./index-BKFclUgu.js";import"./index-3PA7WflP.js";import"./index-Cl_G2Ve8.js";import"./index-OQNNVa3d.js";import"./floating-ui.utils.dom-kEtt1HkL.js";import"./index-BQXxF95v.js";import"./index-CDlc-Urf.js";import"./app-sidebar-layout-CYffyFM9.js";import"./box-BdAADrnp.js";const G=[{title:"Dashboard",href:route("app.dashboard")},{title:"Pedidos",href:route("app.products.index")},{title:"Adicionar",href:"#"}];function ge({order:t,orderitems:J,customers:g,products:v,flex:c}){var h;const n=g.map(s=>({value:s.id,label:s.name})),[d,K]=f.useState([]),y=t.order_items.reduce((s,a)=>s+a.quantity*a.price,0),S=s=>v.find(a=>a.id===s),{data:m,setData:l,post:w,errors:T}=F({customer_id:"",flex:"",discount:"",total:"",items:""});f.useEffect(()=>{l("items",d),l(s=>({...s,flex:q(s==null?void 0:s.flex)})),l("total",d.reduce((s,a)=>s+a.quantity*a.price,0).toFixed(2))},[d,m==null?void 0:m.flex]);const C=async s=>{s.preventDefault(),w(route("app.orders.store"))},I=s=>{l("customer_id",s==null?void 0:s.value)},B=n==null?void 0:n.filter(s=>s.value==(t==null?void 0:t.customer_id)).map(s=>({value:s.value,label:s.label}));return e.jsxs(E,{children:[e.jsx(_,{title:"Pedidos"}),e.jsxs("div",{className:"flex items-center justify-between h-16 px-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{iconNode:N,className:"w-8 h-8"}),e.jsx("h2",{className:"text-xl font-semibold tracking-tight",children:"Pedidos"})]}),e.jsx("div",{children:e.jsx(R,{breadcrumbs:G})})]}),e.jsxs("div",{className:"flex items-center justify-between p-4",children:[e.jsx("div",{children:e.jsx(D,{variant:"default",asChild:!0,children:e.jsxs(P,{href:route("app.orders.index"),children:[e.jsx(H,{"h-4":!0,"w-4":!0}),e.jsx("span",{children:"Voltar"})]})})}),e.jsx("div",{})]}),e.jsx("div",{className:"p-4",children:e.jsxs("form",{onSubmit:C,children:[e.jsxs(p,{className:"mb-4 p-2",children:[e.jsxs(j,{className:"flex items-center gap-2 font-bold mb-2",children:[e.jsx(V,{className:"w-6 h-6"})," Cliente"]}),e.jsx(L,{isDisabled:!0,defaultValue:B,options:n,onChange:I,placeholder:"Selecione o cliente",className:"shadow-xs p-0 border text-gray-700 border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 h-9",styles:{control:(s,a)=>({...s,fontSize:"14px",boxShadow:"none",border:"none",background:"transparent",paddingBottom:"2px"}),dropdownIndicator:s=>({...s}),menuList:s=>({...s,fontSize:"14px"})}}),e.jsx($,{className:"mt-2",message:T.customer_id})]}),e.jsxs(p,{className:"mb-4 p-2",children:[e.jsxs(j,{className:"flex items-center gap-2 font-bold mb-2",children:[e.jsx(N,{className:"w-6 h-6"})," Resumo do Pedido"]}),e.jsxs(M,{className:"w-full table-auto",children:[e.jsx(Q,{children:e.jsxs(u,{className:"text-left",children:[e.jsx(o,{className:"p-2",children:"Produto"}),e.jsx(o,{className:"p-2",children:"Quantidade"}),e.jsx(o,{className:"p-2",children:"Preço Unitário"}),e.jsx(o,{className:"p-2",children:"Total"}),e.jsx(o,{className:"p-2",children:"Ações"})]})}),e.jsx(U,{children:(h=t==null?void 0:t.order_items)==null?void 0:h.map(s=>{var a;return e.jsxs(u,{className:"border-b",children:[e.jsx(r,{className:"p-2",children:(a=S(s.product_id))==null?void 0:a.name}),e.jsx(r,{className:"p-2",children:s.quantity}),e.jsxs(r,{className:"p-2",children:["R$ ",i(s.price.toString())]}),e.jsxs(r,{className:"p-2",children:["R$ ",i((s.quantity*s.price).toFixed(2))]}),e.jsx(r,{className:"p-2"})]},s.product_id)})}),e.jsx(z,{children:e.jsxs(u,{children:[e.jsx(r,{colSpan:3,className:"text-right font-bold p-2",children:"Total:"}),e.jsxs(r,{colSpan:2,className:"font-bold p-2",children:["R$ ",i(y.toFixed(2))]})]})})]})]}),e.jsx(p,{className:"mb-4 p-2",children:e.jsxs("div",{className:"flex items-center justify-start gap-6",children:[e.jsxs("div",{className:"gap-1 flex flex-col items-center justify-center",children:[e.jsx(x,{children:"Flex diponível"}),e.jsxs(k,{variant:"default",className:"text-lg top-4",children:["R$ ",i(c==null?void 0:c.value)]})]}),e.jsxs("div",{className:"gap-2",children:[e.jsx(x,{htmlFor:"flex",children:"Flex"}),e.jsx(b,{type:"text",id:"flex",value:i(t.flex),onChange:s=>l("flex",s.target.value)})]}),e.jsxs("div",{className:"gap-2",children:[e.jsx(x,{htmlFor:"discount",children:"Desconto"}),e.jsx(b,{type:"text",id:"discount",value:i(t.discount),onChange:s=>l("discount",s.target.value)})]})]})})]})})]})}export{ge as default};
